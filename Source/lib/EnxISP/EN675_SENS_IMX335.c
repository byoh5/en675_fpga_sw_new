/* **************************************************************************
 File Name	:	EN675_SENS_IMX335.c
 Description:	EN675 - IMX335 device driver
 Designer	:	Sung, Min-Je
 Date		:	19. 6. 11
 Copyright ¨Ï Eyenix Co., Ltd. All Rights Reserved.
*************************************************************************** */

#define __SENS_LIST__
#include "dev_model.h"				// EN675 - __SENS_LIST__
#define model_Sens	SENS_IMX335

#include "isp_lib_main.h"

//-------------------------------------------------------------------------------------------------

	const WORD gTblMIPI_IMX335_0[][2]	= {
						{0x300c,	0x42},
						{0x300d,    0x2e}
						};
	const WORD gTblMIPI_IMX335_1[][3]	= {
								 // Nor 4M30P
						{0x3018,    0x04,			0x00},
						{0x302c,    0x3c,			0x30},
						{0x302d,    0x00,			0x00},
						{0x302e,    0x20,			0x38},
						{0x302f,    0x0a,			0x0a},
						{0x3030,    0xe4,			0x56},
						{0x3031,    0x0c,			0x13}
						};
	const WORD gTblMIPI_IMX335_2[][2]	= {
						{0x3032,    0x00},
						{0x3033,    0x00}
						};
	const WORD gTblMIPI_IMX335_3[][3]	= {
								 // Nor 5M12.5P
						{0x3034,    0xb0,			0xee},
						{0x3035,    0x04,			0x02}
						};
	const WORD gTblMIPI_IMX335_4[][2]	= {
						{0x3048,    0x00},
						{0x3049,    0x00},
						{0x304a,    0x03},
						{0x304b,    0x03},
						{0x304c,    0x14},
						{0x304e,    0x00},
						{0x304f,    0x00},
						{0x3050,    0x01}
						};
	const WORD gTblMIPI_IMX335_5[][3]	= {
								 // Nor 4M30P
						{0x3056,    0x50,			0xac},
						{0x3057,    0x0b,			0x07}
						};
	const WORD gTblMIPI_IMX335_6[][2]	= {
						{0x3058,    0x09},
						{0x3059,    0x00},
						{0x305a,    0x00},
						{0x305c,    0x12},
						{0x305d,    0x00},
						{0x305e,    0x00},
						{0x3060,    0x00},
						{0x3061,    0x00},
						{0x3062,    0x00},
						{0x3068,    0xce},
						{0x3069,    0x00},
						{0x306a,    0x00},
						{0x306c,    0x00},
						{0x306d,    0x00},
						{0x306e,    0x00},
						{0x3072,    0x28},
						{0x3073,    0x00},
						{0x3074,    0xb0}
						};
	const WORD gTblMIPI_IMX335_7[][3]	= {
								 // Nor 4M30P
						{0x3075,    0x01,			0x00},
						{0x3076,    0x50,			0x58},
						{0x3077,    0x0b,			0x0f},
						{0x30c6,    0x12,			0x00},
						{0x30c7,    0x00,			0x00},
						{0x30ce,    0x64,			0x00},
						{0x30cf,    0x00,			0x00},
						{0x30d8,    0xd0,			0x4c},
						{0x30d9,    0x0d,			0x10}
						};
	const WORD gTblMIPI_IMX335_8[][2]	= {
						{0x30e8,    0x00},
						{0x30e9,    0x00},
						{0x30ea,    0x00},
						{0x30eb,    0x00},
						{0x30ec,    0x00},
						{0x30ed,    0x00},

						//0x31**
						{0x314c,    0x08},
						{0x314d,    0x01},
						{0x315a,    0x06},
						{0x3168,    0x8f},
						{0x316a,    0x7e},
						{0x3199,    0x00},
						{0x319d,    0x01},
						{0x319e,    0x02},
						{0x319f,    0x01},
						{0x31a0,    0x2a},
						{0x31d4,    0x00},
						{0x31d5,    0x00},
						{0x31d7,    0x00},

						//0x32**
						{0x3200,    0x01},
						{0x3288,    0x21},
						{0x328a,    0x02},

						//0x33**
						{0x3300,    0x00},
						{0x3302,    0x00},
						{0x3303,    0x00},

						//0x34**
						{0x3414,    0x05},
						{0x3416,    0x18},
						{0x341c,    0x47},
						{0x341d,    0x00},

						//0x36**
						{0x3648,    0x01},
						{0x364a,    0x04},
						{0x364c,    0x04},
						{0x3678,    0x01},
						{0x367c,    0x31},
						{0x367e,    0x31},

						//0x37**
						{0x3706,    0x10},
						{0x3708,    0x03},
						{0x3714,    0x02},
						{0x3715,    0x02},
						{0x3716,    0x01},
						{0x3717,    0x03},
						{0x371c,    0x3d},
						{0x371d,    0x3f},
						{0x372c,    0x00},
						{0x372d,    0x00},
						{0x372e,    0x46},
						{0x372f,    0x00},
						{0x3730,    0x89},
						{0x3731,    0x00},
						{0x3732,    0x08},
						{0x3733,    0x01},
						{0x3734,    0xfe},
						{0x3735,    0x05},
						{0x3740,    0x02},
						{0x375d,    0x00},
						{0x375e,    0x00},
						{0x375f,    0x11},
						{0x3760,    0x01},
						{0x3768,    0x1b},
						{0x3769,    0x1b},
						{0x376a,    0x1b},
						{0x376b,    0x1b},
						{0x376c,    0x1a},
						{0x376d,    0x17},
						{0x376e,    0x0f},
						{0x3776,    0x00},
						{0x3777,    0x00},
						{0x3778,    0x46},
						{0x3779,    0x00},
						{0x377a,    0x89},
						{0x377b,    0x00},
						{0x377c,    0x08},
						{0x377d,    0x01},
						{0x377e,    0x23},
						{0x377f,    0x02},
						{0x3780,    0xd9},
						{0x3781,    0x03},
						{0x3782,    0xf5},
						{0x3783,    0x06},
						{0x3784,    0xa5},
						{0x3788,    0x0f},
						{0x378a,    0xd9},
						{0x378b,    0x03},
						{0x378c,    0xeb},
						{0x378d,    0x05},
						{0x378e,    0x87},
						{0x378f,    0x06},
						{0x3790,    0xf5},
						{0x3792,    0x43},
						{0x3794,    0x7a},
						{0x3796,    0xa1},
						{0x37b0,    0x36},

						//0x3a**
						{0x3a01,    0x03},
						{0x3a18,    0x7f},
						{0x3a19,    0x00},
						{0x3a1a,    0x37},
						{0x3a1b,    0x00},
						{0x3a1c,    0x37},
						{0x3a1d,    0x00},
						{0x3a1e,    0xf7},
						{0x3a1f,    0x00},
						{0x3a20,    0x3f},
						{0x3a21,    0x00},
						{0x3a22,    0x6f},
						{0x3a23,    0x00},
						{0x3a24,    0x3f},
						{0x3a25,    0x00},
						{0x3a26,    0x5f},
						{0x3a27,    0x00},
						{0x3a28,    0x2f},
						{0x3a29,    0x00}
						};

void InitSensRun(void)
{
	SetSens(0x3000, 0x1);	WaitXus(1000);		// standby
	SetSens(0x3002, 0x1);	WaitXus(1000);		// xmaster stop
	SetSens(0x3001, 0x01);					// REG Hold
	SetSens(0x3003, 0x01);					// SW rese

	UINT i;
	#define MIPI_IMX335_INIT(N,I) for(i=0;i<ARRAY_SIZE(gTblMIPI_IMX335_##N); i++) { SetSens(gTblMIPI_IMX335_##N[i][0],gTblMIPI_IMX335_##N[i][I]); /*WaitXus(200);*/ }

	MIPI_IMX335_INIT(0,1)

	if (gbSensFps==30) {
		MIPI_IMX335_INIT(1,1)
	} else {
		MIPI_IMX335_INIT(1,2)
	}

	MIPI_IMX335_INIT(2,1)

	if (gbSensFps==12) {
		MIPI_IMX335_INIT(3,1)
	} else {
		MIPI_IMX335_INIT(3,2)
	}

	MIPI_IMX335_INIT(4,1)

	if (gbSensFps==30) {
		MIPI_IMX335_INIT(5,1)
	} else {
		MIPI_IMX335_INIT(5,2)
	}

	MIPI_IMX335_INIT(6,1)

	if (gbSensFps==30) {
		MIPI_IMX335_INIT(7,1)
	} else {
		MIPI_IMX335_INIT(7,2)
	}

	MIPI_IMX335_INIT(8,1)

	SetSens(0x3003, 0x00);						// SW reset OFF
	SetSens(0x3001, 0x00);						// REG Hold OFF
	SetSens(0x3000, 0x0);	WaitXus(30000);		// standby cancel
	SetSens(0x3002, 0x0);	WaitXus(20000);		// xmaster
}

