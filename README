EN675 CPU code
=====================================


코드 구성
---------

FPGA ver 19.10.16 14:08 입니다.
이 코드는 Flash이 없는 환경에서 테스트 되었습니다. Source Code는 DDR에서 작동중입니다.
DDR 메모리의 용량 및 작동주파수, log view s/w(Teraterm/Putty or ECM)에 따라서 Debug폴더에 있는 아래의 파일을 ddrinit.elf로 이름을 변경합니다.
  40.5MHz/81MHz   1Gb: ddrinit_40.5Mhz_1Gb.elf   / ddrinit_40.5Mhz_1Gb_ECM.elf
  40.5MHz/81MHz 512Mb: ddrinit_40.5Mhz_512Mb.elf / ddrinit_40.5Mhz_512Mb_ECM.elf
  50.0MHz/75MHz   1Gb: ddrinit_50Mhz_1Gb.elf     / ddrinit_50Mhz_1Gb_ECM.elf
  50.0MHz/75MHz 512Mb: ddrinit_50Mhz_512Mb.elf   / ddrinit_50Mhz_512Mb_ECM.elf
  54.0MHz/81MHz   1Gb: ddrinit_54Mhz_1Gb.elf     / ddrinit_54Mhz_1Gb_ECM.elf
  54.0MHz/81MHz 512Mb: ddrinit_54Mhz_512Mb.elf   / ddrinit_54Mhz_512Mb_ECM.elf

"\\192.168.0.10\_연구소_Team2\_EN675\Document\EN675_Ver0.4_개발환경구성_Cmake.pdf" 을 참조하시기 바랍니다.

CPU0, 1, 2, 3은 source/core폴더에서 core0, core1, core2, core3의 main_.c 파일을 root로 합니다.
CPU1에서 freeRTOS가 작동중입니다. DDR BSS영역 뒤의 4MByte 영역을 RTOS Heap 영역으로 사용합니다.
만약 freeRTOS를 사용하지 않는다면 Cmake/device.cmake의 USE_FREERTOS 부분을 찾아 0으로 수정하시면 됩니다.


메모리 구성
---------

Code에서 사용하고 있는 메모리는 DDR memory입니다. EN675_Ver0.4_개발환경구성_Cmake.pdf에 따라 부팅을 할 경우,
ddrinit.elf가 SRAM으로 부팅 및 DDR memory 초기화 작업을 진행 후, 이클립스에서 바이너리를 DDR로 dump합니다.

|               |
|               |
|---------------| 0x8000_0000 (DDR START)
| .reset        |
|---------------| 0x8000_0500
| .text         |
|---------------| 0x800B_0580
| .redata       |
|---------------| 0x8033_E200
| .data         |
|---------------| 0x8034_4000
| .bss          |
|---------------| 0x8040_5780
| .heap         |
|---------------| 0x8080_5780
|               |
|         empty |
|               |
|---------------| 0x8400_0000 (DDR END - 64MB)
|               |
|         empty |
|               |
|---------------| 0x87FF_FFFF (DDR END - 128MB)
|               |
|         empty |
|               |
|---------------| 0x8FFF_FFFF (DDR END - 256MB)
|               |
|               |
|               |
|               |
|               |
|               |
|---------------| 0xA000_0000 (SRAM START)
|               |
|         empty |
|               |
|---------------| 0xA004_0000 (SRAM END - 256KB)
|               |
|               |
|               |
|               |
|               |
|               |
|---------------| 0xC000_0000 (SFLS START)
|               |
|         empty |
|               |
|---------------| 0xC100_0000 (SFLS END - 16MB)
|               |
|         empty |
|               |
|---------------| 0xC200_0000 (SFLS END - 32MB)
|               |
|               |


이클립스 구성
---------

이클립스에서 디버깅모드를 사용하기 위해 Debug와 Release로 구성이 나뉘어 있습니다. Debug는 -O0옵션을 사용하며, Release는 -Os옵션을 사용합니다.
이클립스에 추가할 때, Debug 모드의 경우 Debug 폴더의 .project와 .cproject가 root가 되겠습니다.


코드 컴파일
---------

이 코드는 Cmake 기반의 makefile으로 구성되어 있습니다. 이 소스코드를 컴파일 하기 위해서는 Cmake를 설치해야 합니다.
Cmake의 버전은 최소 3.13.2가 되어야 하며, https://cmake.org/download/ 에서 다운로드 받을 수 있습니다.


